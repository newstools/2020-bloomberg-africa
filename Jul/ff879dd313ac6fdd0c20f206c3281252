On Friday morning Angela Merkel and Emmanuel Macron were sipping mineral water on a sunlit terrace overlooking Brussels as negotiations began on a 750 billion-euro ($860 billion) European stimulus package they’d sketched out two months earlier. By the early hours of Monday, the leaders of Germany and France were refueling on potato chips and wine as they battled to hold the talks together. “Crunchtime,” said Dutch Prime Minister Mark Rutte, as he joined them for yet another side meeting with Italy’s Giuseppe Conte and European Commission President Ursula von der Leyen. With the economy reeling from the effects of the pandemic and investors looking for a response, the plan that Merkel and Macron had come up with would mean a historic step forward for the European project if they could pull it off. This was the moment it finally started to come together. Rarely has a meeting of the European Union’s 27 leaders so dramatically exposed the divisions between them. And yet they’ve emerged at the end of it with an agreement that may well come to be considered a watershed in the long, uncertain process of EU integration. Read More: EU Leaders Clinch 750 Billion-Euro Coronavirus Recovery Fund This account of one of the most difficult negotiations in the EU’s 63-year history is based on reports from officials inside the talks who spoke on the condition of anonymity because of the sensitive nature of the discussions. As the group gathered Friday to meet in person for the first time since the pandemic struck, they knew where the dividing lines were. The outcome of the summit would hinge on persuading Rutte and his allies from Austria, Denmark and Sweden to accept an unprecedented transfer of resources to the southern economies that had suffered the most from the outbreak. The initial proposal by European Council President Charles Michel involved making 500 billion euros available as handouts to avoid piling more debt onto their strained balance sheets. Under EU rules, the deal would need unanimity. But the good-natured conversations of Friday morning descended into a war of words by Friday night as Rutte attacked the commission for its track record in ensuring member states manage their finances. Von der Leyen, the commission chief, sat silently as Rutte reminded the group of occasions when the EU executive had failed to enforce financial rules. Diplomats asked themselves why on earth she wasn’t defending the institution she’s led since December. The Dutch leader said the atmosphere had been “cranky.” From left, Mark Rutte, Angela Merkel, Ursula von der Leyen, and Emmanuel Macron during stimulus negotiations in Brussels, on July 18 Photographer: Francisco Seco/AFP via Getty Images The pandemic has seen a resurgence of the partnership between Merkel, who celebrated her 66th birthday on the first day of the talks, and 42 year-old Macron. She’s come to the fore for one more crisis as her chancellorship draws to a close. He has been calling for EU integration since his 2017 election victory. Together, they agreed that 500 billion euros of grants should be the starting point in the negotiations. On Saturday morning, with Rutte and his allies refusing to accept that amount of handouts, Michel issued a new proposal, this time calling for 450 billion euros in grants. That night Merkel and Macron met with Rutte as they tried to find a way forward and left, abruptly, after their efforts hit a wall. “They are walking away grumpy,” said Rutte, knowing he’d have to take any deal for ratification to a Dutch parliament where he has exactly 50% of the seats. By Sunday lunchtime, the atmosphere had gotten so bad that diplomats on all sides were warning that the talks could collapse at any moment, a devastating failure that could send financial markets reeling. “Europe is being blackmailed,” Italy’s Conte told reporters. Conte and Rutte faced off at a meeting that afternoon where the Italian leader accused his Dutch counterpart of being deluded. Two officials with knowledge of the exchange said that Conte told Rutte his intransigence might make him a hero for a day at home but it would come at a high cost for Europe in the long run, though that account was disputed by a Dutch official. Conte, a university law professor before he entered politics, was outraged by Dutch demands for a veto on individual disbursements, telling Rutte that it wasn’t consistent with EU law. All the same, the two sides were starting to move. Michel’s next proposal called for 400 billion euros of grants. Rutte and his allies said they could go to 350 billion. Macron and Merkel met with leaders of eastern countries concerned their payments would only come through if they respected the independence of institutions like the courts and the media. Dinner on Sunday was cold meats and salad around 7 p.m. Von der Leyen responded to Rutte’s criticism from Friday and got a round of applause from other leaders. An angry Macron accused the holdouts of ignoring financial realities and then scolded Austrian Chancellor Sebastian Kurz for getting up to take a phone call. “We negotiated for 20 hours,” Kurz said later. “I find that stepping out is sometimes quite normal.” “It is understandable that some people, if they get little sleep, at some point lose their cool,” he added. As the clock ticked past midnight into day four, the fiscal hawks held frantic discussions over a bowl of cherries. Portugal’s Antonio Costa sprawled out on a sofa as he waited for all the leaders to reconvene. Aides napped in the corridors. Merkel and Macron huddled with Conte and von der Leyen before calling Rutte into the meeting. That’s where they found the wording on governance of the fund that both Italy and the Netherlands could live with. Rutte left the meeting telling Italian officials outside that the new language meant that he had no veto. A consensus started to form around 390 billion euros of grants. By the time the delegations left the Europa building some time after dawn, officials from the hardline camp were saying they could do a deal. Monday was about fleshing out the details and mending bridges as officials combed Brussels for extra underwear and fresh face masks. Merkel had clashed with Danish Prime Minister Mette Frederiksen on Sunday. To make up for the incident, she bought her counterpart chocolates they shared them on the sidelines of the talks. By dinner -- carrot soup, cod and lemon cake -- all 27 were broadly satisfied, but they were still pushing for more as the details were settled. Italian officials celebrated when Conte won a change in the leaders’ obligations when overseeing the fund -- objections would have to be analyzed not “decisively” but “exhaustively.” The Danes got more than 50 million euros added to their budget rebate arguing that there was a typo in the text. At the last minute, provisions aimed at halting sliding democratic standards were diluted. Even then, leaders had to wait several hours for the paperwork to be finalized. Danish officials talked movies, the Lithuanians played chess, Kurz returned to the Austrian delegation room with his team and sipped Diet Coke as they swapped reflections about the previous four days. Shortly after 5 a.m. Tuesday, the 27 leaders gathered one last time on the fifth floor of the Europa Building. Afterwards Rutte joked that they had been within touching distance of eclipsing the longest ever summit from 2000. But more importantly, the deal was done. “When you have negotiations that are as intense as these, they trigger emotions on the part of all participants, they release adrenaline,” Michel said afterward. “Sometimes you get the feeling that it’s not going to work, sometimes you feel you might need to give up, sometimes you feel you just have to roll your sleeves up and push on.” — With assistance by Boris Groendahl, Morten Buttler, Milda Seputyte, Diederik Baazil, and Jonathan Stearns